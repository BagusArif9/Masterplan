THREE.OrbitControlsTH=function(t,e){function o(){return 2*Math.PI/60/60*p.autoRotateSpeed}function n(){return Math.pow(.95,p.zoomSpeed)}function a(t){if(p.enabled!==!1){if(t.preventDefault(),t.button===p.mouseButtons.ORBIT){if(p.noRotate===!0)return;C=z.ROTATE,b.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.ZOOM){if(p.noZoom===!0)return;C=z.DOLLY,R.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.PAN){if(p.noPan===!0)return;C=z.PAN,y.set(t.clientX,t.clientY)}C!==z.NONE&&(document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",s,!1),p.dispatchEvent(V))}}function i(t){if(p.enabled!==!1){t.preventDefault();var e=p.domElement===document?p.domElement.body:p.domElement;if(C===z.ROTATE){if(p.noRotate===!0)return;f.set(t.clientX,t.clientY),v.subVectors(f,b),p.rotateLeft(2*Math.PI*v.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*v.y/e.clientHeight*p.rotateSpeed),b.copy(f)}else if(C===z.DOLLY){if(p.noZoom===!0)return;H.set(t.clientX,t.clientY),j.subVectors(H,R),j.y>0?p.dollyIn():j.y<0&&p.dollyOut(),R.copy(H)}else if(C===z.PAN){if(p.noPan===!0)return;T.set(t.clientX,t.clientY),g.subVectors(T,y),p.pan(g.x,g.y),y.copy(T)}C!==z.NONE&&p.update()}}function s(){p.enabled!==!1&&(document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",s,!1),p.dispatchEvent(U),C=z.NONE)}function r(t){if(p.enabled!==!1&&p.noZoom!==!0&&C===z.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?p.dollyOut():0>e&&p.dollyIn(),p.update(),p.dispatchEvent(V),p.dispatchEvent(U)}}function c(t){if(p.enabled!==!1&&p.noKeys!==!0&&p.noPan!==!0)switch(t.keyCode){case p.keys.UP:p.move(0,Math.pow(p.flyspeed,2)/250),p.update();break;case p.keys.BOTTOM:p.move(0,-Math.pow(p.flyspeed,2)/250),p.update();break;case p.keys.LEFT:p.move(Math.pow(p.flyspeed,2)/250,0),p.update();break;case p.keys.RIGHT:p.move(-Math.pow(p.flyspeed,2)/250,0),p.update()}}function h(t){if(p.enabled!==!1){switch(t.touches.length){case 1:if(p.noRotate===!0)return;C=z.TOUCH_ROTATE,b.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;C=z.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+o*o);R.set(0,n);break;case 3:if(p.noPan===!0)return;C=z.TOUCH_PAN,y.set(t.touches[0].pageX,t.touches[0].pageY);break;default:C=z.NONE}C!==z.NONE&&p.dispatchEvent(V)}}function m(t){if(p.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=p.domElement===document?p.domElement.body:p.domElement;switch(t.touches.length){case 1:if(p.noRotate===!0)return;if(C!==z.TOUCH_ROTATE)return;f.set(t.touches[0].pageX,t.touches[0].pageY),v.subVectors(f,b),p.rotateLeft(2*Math.PI*v.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*v.y/e.clientHeight*p.rotateSpeed),b.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(C!==z.TOUCH_DOLLY)return;var o=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(o*o+n*n);H.set(0,a),j.subVectors(H,R),j.y>0?p.dollyOut():j.y<0&&p.dollyIn(),R.copy(H),p.update();break;case 3:if(p.noPan===!0)return;if(C!==z.TOUCH_PAN)return;T.set(t.touches[0].pageX,t.touches[0].pageY),g.subVectors(T,y),p.pan(g.x,g.y),y.copy(T),p.update();break;default:C=z.NONE}}}function l(){p.enabled!==!1&&(p.dispatchEvent(U),C=z.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.lookaround=!0,this.flyspeed=50;var d,u,p=this,E=1e-6,b=new THREE.Vector2,f=new THREE.Vector2,v=new THREE.Vector2,y=new THREE.Vector2,T=new THREE.Vector2,g=new THREE.Vector2,M=new THREE.Vector3,O=new THREE.Vector3,R=new THREE.Vector2,H=new THREE.Vector2,j=new THREE.Vector2,w=0,P=0,N=1,x=new THREE.Vector3,A=new THREE.Vector3,L=new THREE.Quaternion,z={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},C=z.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var k=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),I=k.clone().inverse(),D={type:"change"},V={type:"start"},U={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=o()),P-=t},this.rotateUp=function(t){void 0===t&&(t=o()),w-=t},this.panLeft=function(t){var e=this.object.matrix.elements;M.set(e[0],e[1],e[2]),M.multiplyScalar(-t),x.add(M)},this.panUp=function(t){var e=this.object.matrix.elements;M.set(e[4],e[5],e[6]),M.multiplyScalar(t),x.add(M)},this.moveForward=function(t){var e=this.object.matrix.elements;M.set(e[8],e[9],e[10]),M.multiplyScalar(-t),x.add(M)},this.move=function(t,e){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,a=n.clone().sub(p.target),i=a.length();i*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(t),p.moveForward(e)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/o.clientWidth),p.moveForward(e*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.pan=function(t,e){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,a=n.clone().sub(p.target),i=a.length();i*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*t*i/o.clientHeight),p.panUp(2*e*i/o.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/o.clientWidth),p.panUp(e*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?N/=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),p.object.updateProjectionMatrix(),p.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?N*=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),p.object.updateProjectionMatrix(),p.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){if(1==p.lookaround){var t=this.object.position;O.copy(this.target).sub(t),O.applyQuaternion(k),d=Math.atan2(O.x,O.z),u=Math.atan2(Math.sqrt(O.x*O.x+O.z*O.z),O.y),this.autoRotate&&C===z.NONE&&this.rotateLeft(o()),d+=P,u+=-w,d=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,d)),u=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,u)),u=Math.max(E,Math.min(Math.PI-E,u));var e=O.length()*N;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),t.add(x),O.x=e*Math.sin(u)*Math.sin(d),O.y=e*Math.cos(u),O.z=e*Math.sin(u)*Math.cos(d),O.applyQuaternion(I),this.target.copy(t).add(O),this.object.lookAt(this.target),P=0,w=0,N=1,x.set(0,0,0)}else{var t=this.object.position;O.copy(t).sub(this.target),O.applyQuaternion(k),d=Math.atan2(O.x,O.z),u=Math.atan2(Math.sqrt(O.x*O.x+O.z*O.z),O.y),this.autoRotate&&C===z.NONE&&this.rotateLeft(o()),d+=P,u+=w,d=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,d)),u=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,u)),u=Math.max(E,Math.min(Math.PI-E,u));var e=O.length()*N;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(x),O.x=e*Math.sin(u)*Math.sin(d),O.y=e*Math.cos(u),O.z=e*Math.sin(u)*Math.cos(d),O.applyQuaternion(I),t.copy(this.target).add(O),this.object.lookAt(this.target),P=0,w=0,N=1,x.set(0,0,0)}(A.distanceToSquared(this.object.position)>E||8*(1-L.dot(this.object.quaternion))>E)&&(this.dispatchEvent(D),A.copy(this.object.position),L.copy(this.object.quaternion))},this.reset=function(){C=z.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(D),this.update()},this.getPolarAngle=function(){return u},this.getAzimuthalAngle=function(){return d},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",r,!1),this.domElement.addEventListener("DOMMouseScroll",r,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",m,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControlsTH.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControlsTH.prototype.constructor=THREE.OrbitControlsTH;